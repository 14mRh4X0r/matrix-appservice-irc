"$schema": "http://json-schema.org/draft-04/schema#"
type: "object"
properties:
    appService:
        type: "object"
        properties:
            homeserver:
                type: "object"
                properties:
                    url:
                        type: "string"
                    domain:
                        type: "string"
                required: ["url", "domain"]
            appservice:
                type: "object"
                properties:
                    url:
                        type: "string"
                    token:
                        type: "string"
                required: ["url", "token"]
            http:
                type: "object"
                properties:
                    port:
                        type: "integer"
                    maxSize:
                        type: "integer"
                required: ["port"]
            localpart:
                "type": "string"
        required: ["homeserver", "appservice", "http"]
    ircService:
        type: "object"
        properties:
            databaseUri:
                type: "string"
            statsd:
                type: "object"
                properties:
                    hostname:
                        type: "string"
                    port:
                        type: "integer"
                required: ["hostname", "port"]
            ident:
                type: "object"
                properties:
                    enabled:
                        type: "boolean"
                    port:
                        type: "integer"
                    hashUsernames:
                        type: "boolean"
                required: ["enabled"]
            logging:
                type: "object"
                properties:
                    level:
                        type: "string"
                        enum: ["error","warn","info","debug"]
                    logfile:
                        type: "string"
                    errfile:
                        type: "string"
                    toConsole:
                        type: "boolean"
                    maxFileSizeBytes:
                        type: "integer"
                    maxFiles:
                        type: "integer"
            servers:
                type: "object"
                # all properties must follow the following
                additionalProperties:
                    type: "object"
                    properties:
                        port:
                            type: "integer"
                        ssl:
                            type: "boolean"
                        botConfig:
                            type: "object"
                            properties:
                                nick:
                                    type: "string"
                                password:
                                    type: "string"
                        privateMessages:
                            type: "object"
                            properties:
                                enabled:
                                    type: "boolean"
                                exclude:
                                    type: "array"
                                    items:
                                        type: "string"
                        dynamicChannels:
                            type: "object"
                            properties:
                                enabled:
                                    type: "boolean"
                                published:
                                    type: "boolean"
                                createAlias:
                                    type: "boolean"
                                joinRule:
                                    type: "string"
                                    enum: ["invite", "public"]
                                federate:
                                    type: "boolean"
                                aliasTemplate:
                                    type: "string"
                                    pattern: "^#.*\\$CHANNEL"
                                whitelist:
                                    type: "array"
                                    items:
                                        type: "string"
                                        pattern: "^@.*"
                                exclude:
                                    type: "array"
                                    items:
                                        type: "string"
                        mappings:
                            type: "object"
                            patternProperties:
                                # must start with a #
                                "^#+.*$":
                                    type: "array"
                                    items:
                                        type: "string"
                                    minItems: 1
                                    uniqueItems: true
                            additionalProperties: false
                        matrixClients:
                            type: "object"
                            properties:
                                userTemplate:
                                    type: "string"
                                    pattern: "^@.*\\$NICK"
                                displayName:
                                    type: "string"
                                    pattern: "\\$NICK"
                                mirrorJoinPart:
                                    type: "boolean"
                        ircClients:
                            type: "object"
                            properties:
                                nickTemplate:
                                    type: "string"
                                    pattern: "\\$USERID|\\$LOCALPART|\\$DISPLAY"
                                maxClients:
                                    type: "integer"
                                idleTimeout:
                                    type: "integer"
                                    minimum: 0
                                allowNickChanges:
                                    type: "boolean"
        required: ["databaseUri", "servers"]